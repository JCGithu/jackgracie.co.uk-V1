<!DOCTYPE html>
<html>
  <head>
    <title>Id Parser</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="shortcut icon" href="./dist/favicon.ico" />
    <link rel="stylesheet" href="./assets/css/idparse.css" />
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
  </head>
  <body>
    <script>
      let fail = false
      function grabID() {
        var inputText = document.getElementById('input').value;
        let finalText = document.getElementById('output');
        let finalBox = document.getElementById('outputBox');
        let copyButton = document.getElementById('copyButton');
        if (inputText.search(/(?<=id=")\d*(?=" video)/g) !== -1){
          if (fail) {
            finalBox.classList.remove('bg-red-400');
            finalBox.classList.add('bg-green-400');
            copyButton.innerHTML = 'Copy & Close';
          }
          let copyText = inputText.split('id="')[1].split('" video=')[0];
          finalText.innerHTML = copyText;
        } else {
          finalBox.classList.remove('bg-green-400');
          finalBox.classList.add('bg-red-400');
          finalText.innerHTML = 'Invalid code';
          copyButton.innerHTML = 'Cancel';
          fail = true;
        }
        console.log(finalText.innerHTML);
      }
      function copy(){
        if (!fail){
          let finalText = document.getElementById('output');  
          const el = document.createElement("textarea");
          el.value = finalText.innerHTML;
          document.body.appendChild(el);
          el.select();
          document.execCommand("copy");
          document.body.removeChild(el);
        }
      }
    </script>
    <div class="flex items-center h-screen w-full bg-gray-900" x-data="{ open: false }">
      <div class="w-full bg-white rounded shadow-lg p-8 m-4 md:max-w-screen-md md:mx-auto lg:text-center">
        <h1 class="mt-2 text-2xl leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl">Hello!</h1>
        <div class="flex flex-col mb-4 md:w-full">
          <h3 class="text-base text-indigo-600 font-semibold tracking-wide">You can use this for the metro video widget!</h2>
          <p class="mt-2 max-w-2xl text-l text-gray-500 lg:mx-auto">
            Input a metro-video embed code and this site will produce the ID!
          </p>
        </div>
        <div class="flex flex-col mb-4 md:w-full flex-shrink-0">
          <form class="flex flex-row">
            <span
              class="flex items-center bg-gray-100 rounded rounded-r-none border-0 px-3 font-bold text-grey-100">ðŸŽ¥</span>
            <input
              class="h-16 bg-gray-100 text-grey-darker py-2 font-normal text-grey-darkest border border-gray-100 w-full py-1 px-2 outline-none text-sm text-gray-600"
              type="text" placeholder="Video code?" id='input'>
            <span
              class="flex items-center bg-gray-100 rounded rounded-l-none border-0 px-3 font-bold text-grey-100">
              <button type="button" x-on:click='open=true'class="bg-gredient-dark hover:bg-gredient-light text-xs text-black font-bold py-3 px-6 rounded" onclick="return grabID()">
                Get ID
              </button>
            </span>
          </form>
        </div>
    </div>
    <div class="fixed h-screen w-full flex items-center justify-center" x-show.transition.opacity.duration.700ms="open">    
      <div id='outputBox' class="absolute flex flex-col items-center text-center justify-center bg-green-400 z-10 w-64 h-32 rounded-lg" role="alert" >
        <p id='output' class="m-5 p-2 font-bold text-xl animate-bounce"></p>
        <button id='copyButton' type="button" onclick="return copy()" x-on:click='open=false' class="w-auto bg-white text-black p-1 px-3 rounded">Copy & Close</button>
      </div>
    </div>
  </body>
</html>
